{% extends 'dashboard/base_index/base.html' %}
{% load static %}
{% block title %}
Add Organization detail
{% endblock %}
{% block body %}
<link href="{% static 'dashboard/build/css/bootstrap.min.css'%}" id="bootstrap-style" rel="stylesheet" type="text/css" />
<link href="{% static 'dashboard/build/css/icons.min.css'%}" rel="stylesheet" type="text/css" />
<link href="{% static 'dashboard/build/css/app.min.css'%}" id="app-style" rel="stylesheet" type="text/css" />

<!-- ============================================================== -->
<!-- Start right Content here -->
<!-- ============================================================== -->
<div class="main-content">
    <div class="page-content">
        <!-- Start content -->
        <div class="container-fluid">
            
            <div class="row">
                <div class="col-lg-12">
                    <div class="card">
                        <div class="card-body">
                            <blockquote>Organization detail</blockquote>
                            
                            <form  method="post" enctype="multipart/form-data" action="{% if instance %}{% url 'dashboard:company_detail'  %}{% else %}{% url 'dashboard:company_detail' %}{% endif %}" >
                                {% csrf_token %}
                                {{form.media}}
                                {{form.errors}}
                                {% if messages %}
                                {% for msg in messages %}
                                <div class="alert alert-{{ msg.tags }} alert-dismissible text-bg-{{ msg.tags }} border-0 fade show"
                                    role="alert">
                                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="alert"
                                        aria-label="Close"></button>
                                    <strong>{% if msg.tags == 'success' %}Success{% elif msg.tags == 'warning' %}Warning{% endif %} -
                                    </strong>{{ msg.message }}
                                </div>
                                {% endfor %}
                                {% endif %}

                                <div class="row">
                                    <div class="col-xl-6">
                                        <div class="mb-3">
                                        <label class="form-label">Company name</label>
                                        <input type="text" name="{{ form.company_name.name }}" id="{{ form.company_name.id_for_label }}" class="form-control"
                                        value="{% if instance %}{{ instance.company_name }}{% endif %}" placeholder="Enter Company name" required>
                                        </div>

                                        <div class="mb-3">
                                            <label class="form-label">Address</label>
                                            <input type="text" name="{{ form.address.name }}" id="{{ form.address.id_for_label }}" class="form-control"
                                            value="{% if instance %}{{ instance.address }}{% endif %}" placeholder="Enter Company address" required>
                                        </div>

                                        <div class="mb-3">
                                            <label class="form-label">Email</label>
                                            <input type="email" name="{{ form.email.name }}" id="{{ form.email.id_for_label }}" class="form-control"
                                            value="{% if instance %}{{ instance.email }}{% endif %}" placeholder="Enter Company name" required>
                                        </div>

                                        <div class="mb-3">
                                            <label class="form-label">Contact number</label>
                                            <input type="number" name="{{ form.phone.name }}" id="{{ form.phone.id_for_label }}" class="form-control"
                                            value="{% if instance %}{{ instance.phone }}{% endif %}" placeholder="Enter phone number" required>
                                            </div>

                                        <div class="mb-3">
                                            <label for="{{ form.logo.id_for_label }}" class="form-label">Logo :</label>
                                            <input type="file" name="{{ form.logo.name }}" id="{{ form.logo.id_for_label }}" class="form-control" {% if not instance %}required{% endif %} onchange="showPreview(this);">
                                            <div id="logoContainer" style="width:auto; height:auto;">
                                                <img class="img-fluid" id="logoPreview" src="{% if instance %}{{ instance.logo.url }}{% endif %}" alt="" >
                                            </div>
                                        </div>

                                        <div class="mb-3">
                                            <label for="{{ form.footer_logo.id_for_label }}" class="form-label">Footer Logo :</label>
                                            <input type="file" name="{{ form.footer_logo.name }}" id="{{ form.footer_logo.id_for_label }}" class="form-control" {% if not instance %}required{% endif %} onchange="showPreview(this);">
                                            <div id="footer_logoContainer" style="width:auto; height:auto;">
                                                <img class="img-fluid" id="footer_logoPreview" src="{% if instance %}{{ instance.footer_logo.url }}{% endif %}" alt="" >
                                            </div>
                                        </div>

                                        <div class="mb-3">
                                            <label for="{{ form.herobanner.id_for_label }}" class="form-label">Cover photo :</label>
                                            <input type="file" name="{{ form.herobanner.name }}" id="{{ form.herobanner.id_for_label }}" class="form-control" {% if not instance %}required{% endif %} onchange="showPreview(this);">
                                            <div id="herobannerContainer" style="width:auto; height:auto;">
                                                <img class="img-fluid" id="herobannerPreview" src="{% if instance %}{{ instance.herobanner.url }}{% endif %}" alt="" >
                                            </div>
                                        </div>

                                        <div class="mb-3">
                                            <label for="{{ form.favicon.id_for_label }}" class="form-label">Favicon :</label>
                                            <input type="file" name="{{ form.favicon.name }}" id="{{ form.favicon.id_for_label }}" class="form-control" {% if not instance %}required{% endif %} onchange="showPreview(this);">
                                            <div id="faviconContainer" style="width:auto; height:auto;">
                                                <img class="img-fluid" id="faviconPreview" src="{% if instance %}{{ instance.favicon.url }}{% endif %}" alt="" >
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xl-6">

                                        <div class="mb-3">
                                            <label class="form-label">Facebook URL</label>
                                            <input type="url" name="{{ form.facebookUrl.name }}" id="{{ form.facebookUrl.id_for_label }}" class="form-control"
                                            value="{% if instance %}{{ instance.facebookUrl }}{% endif %}" placeholder="Enter facebookUrl" required>
                                        </div>

                                        <div class="mb-3">
                                            <label class="form-label">Instagram URL</label>
                                            <input type="url" name="{{ form.instagramUrl.name }}" id="{{ form.instagramUrl.id_for_label }}" class="form-control"
                                            value="{% if instance %}{{ instance.instagramUrl }}{% endif %}" placeholder="Enter instagramUrl" required>
                                        </div>

                                        <div class="mb-3">
                                            <label class="form-label">Youtube URL</label>
                                            <input type="url" name="{{ form.youtubeUrl.name }}" id="{{ form.youtubeUrl.id_for_label }}" class="form-control"
                                            value="{% if instance %}{{ instance.youtubeUrl }}{% endif %}" placeholder="Enter youtubeUrl" required>
                                        </div>

                                        <div class="mb-3">
                                            <label class="form-label">Description</label>
                                            {{form.description}}
                                        </div>

                                        
                                        
                                    </div>
                                </div>
                                <!-- end row-->
                                <div class="col-auto">
                                    {% if form.initial %}
                                        <button type="submit" class="btn btn-primary chat-send waves-effect waves-light">Update Organization detail</button>
                                    {% else %}
                                        <button type="submit" class="btn btn-primary chat-send waves-effect waves-light">Add Organization detail </button>
                                    {% endif %}
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!-- end row -->
        </div> <!-- content -->
    </div>
    <style>
        select {
            word-wrap: normal;
            width: 567px;
            height: 40px;
            display: flex;
            border: 1px solid #ccc;
        }
        </style>
        <style>
            #imageContainer {
                max-width: 100%;
                max-height: 80%;
                border: 1px solid #ccc;
                display: flex;
                align-items: center;
                justify-content: center;
                overflow: hidden;
            }

            #imagePreview {
                max-width: 100%;
                max-height: 100%;
            }
        </style>
        <script>
            function showPreview(input) {
                if (input.files && input.files[0]) {
                    var reader = new FileReader();
                    reader.onload = function(e) {
                        document.getElementById('imagePreview').src = e.target.result;
                    };
                    reader.readAsDataURL(input.files[0]);
                }
            }

            function showPreview1(input) {
                if (input.files && input.files[0]) {
                    var reader = new FileReader();
                    reader.onload = function(e) {
                        document.getElementById('imagePreview1').src = e.target.result;
                    };
                    reader.readAsDataURL(input.files[0]);
                }
            }
        </script>

        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

        <script>
            function validatePassword1() {
                const password1 = document.getElementById('{{ user_form.password1.id_for_label }}').value;
                const password2 = document.getElementById('{{ user_form.password2.id_for_label }}').value;
        
                // Check if passwords match
                if (password1 !== password2) {
                    document.getElementById('password-message1').innerText = 'Passwords do not match.';
                    return;
                }
        
                // Check if password contains both numbers and alphabetic characters until it reaches 8 characters
                if (password1.length < 8 || (!/\d/.test(password1) || !/[a-zA-Z]/.test(password1))) {
                    document.getElementById('password-message1').innerText = 'Password should contain both numbers and alphabetic characters and be at least 8 characters long.';
                    return;
                }
        
                // Check for similarity with other personal information
                const personalInfo = ['username', 'email', 'name']; // Example personal information
                for (const info of personalInfo) {
                    if (password1.toLowerCase().includes(info.toLowerCase())) {
                        document.getElementById('password-message1').innerText = 'Password can\'t be too similar to your other personal information.';
                        return;
                    }
                }
        
                // Check for common passwords
                const commonPasswords = ['password', '123456', 'qwerty']; // Example common passwords
                if (commonPasswords.includes(password1.toLowerCase())) {
                    document.getElementById('password-message1').innerText = 'Password can\'t be a commonly used password.';
                    return;
                }
        
                // Check if password is entirely numeric
                if (/^\d+$/.test(password1)) {
                    document.getElementById('password-message1').innerText = 'Password can\'t be entirely numeric.';
                    return;
                }
        
                document.getElementById('password-message1').innerText = '';
            }
        
            
            function togglePasswordVisibility(inputId) {
                const input = document.getElementById(inputId);
                const eyeIcon = document.getElementById('eye-icon-' + inputId.split('-').pop());
        
                if (input.type === "password") {
                    input.type = "text";
                    eyeIcon.classList.remove('bi-eye');
                    eyeIcon.classList.add('bi-eye-slash');
                } else {
                    input.type = "password";
                    eyeIcon.classList.remove('bi-eye-slash');
                    eyeIcon.classList.add('bi-eye');
                }
            }
        </script>
        <script>
            function validatePassword(input) {
                const password = input.value;
                const email = document.getElementById('{{ user_form.email.id_for_label }}').value;
        
                // Check if password contains both numbers and alphabetic characters
                if (!/\d/.test(password) || !/[a-zA-Z]/.test(password) || password.length < 8) {
                    document.getElementById('password-message').innerText = 'Password should contain both numbers and alphabetic characters, and be at least 8 characters long.';
                    return;
                }
        
                // Check for similarity with other personal information
                const personalInfo = ['username', 'email', 'name']; // Example personal information
                for (const info of personalInfo) {
                    if (password.toLowerCase().includes(info.toLowerCase())) {
                        document.getElementById('password-message').innerText = 'Password can\'t be too similar to your other personal information.';
                        return;
                    }
                }
        
                // Check for common passwords
                const commonPasswords = ['password', '123456', 'qwerty']; // Example common passwords
                if (commonPasswords.includes(password.toLowerCase())) {
                    document.getElementById('password-message').innerText = 'Password can\'t be a commonly used password.';
                    return;
                }
        
                // Check if password is similar to email
                if (password.toLowerCase().includes(email.split('@')[0].toLowerCase()) || password.toLowerCase().includes(email.split('@')[1].toLowerCase())) {
                    document.getElementById('password-message').innerText = 'Password can\'t be too similar to your email.';
                    return;
                }
        
                document.getElementById('password-message').innerText = '';
            }
        </script>
    
    {%endblock%}